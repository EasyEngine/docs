## EasyEngine on the Filesystem

All files created by EasyEngine are stored at `/opt/easyengine`

## Sites

All EasyEngine sites are created at `/opt/easyengine/sites`. Everything related to a site like source code, database, Configuration and logs of individual site's NGINX, PHP, Postfix are stored in `/opt/easyengine/sites/example.com`. 

Checkout the documentation on [a site's filesystem structure](site-structure.md) to know more about individual site's files.

## Services

There are some containers in EasyEngine which are used by multiple sites. These are called services. We have following services in EasyEngine:

1. MariaDB
2. Nginx Proxy
3. Cron Scheduler

Configuration, logs and other files of these services can be found at `/opt/easyengine/services`

### MariaDB
#### Logs
Logs of MariaDB can be found at `/opt/easyengine/services/mariadb/logs`.

#### Config
Config of MariaDB can be found at `/opt/easyengine/services/mariadb/config`.
You can add custom config at `/opt/easyengine/services/mariadb/conf/mariadb.conf.d/`

#### Data
Data of MariaDB can be found at `/opt/easyengine/services/mariadb/data`.

### Nginx Proxy
#### Logs
Logs of Nginx Proxy can be found at `/opt/easyengine/services/nginx-proxy/logs`.

#### Config
Config of Nginx Proxy can be found at `/opt/easyengine/services/nginx-proxy/conf.d`.

Since we're using containers, the IP assigned to a container is random and if a site's container goes down and is recreated, it gets assigned a new IP. The Nginx Proxy container keeps track of these events and regenerates the nginx configuration to allow traffic for a domain to be passed to the correct Nginx container. This config is regenerated from a [go template](https://github.com/EasyEngine/dockerfiles/blob/master/nginx-proxy/nginx.tmpl) and can be found at `/opt/easyengine/services/nginx-proxy/conf.d/default.conf`.  

Do not modify this file as it gets regenerated whenever a container starts/stops.

You can add proxy wide config in `/opt/easyengine/services/nginx-proxy/conf.d`. Please refer to [jwilder/nginx-proxy's readme](https://github.com/jwilder/nginx-proxy#proxy-wide) for more info.

If you want to add a particular config for all sites, you can create `/opt/easyengine/services/nginx-proxy/vhost.d/default` file and add your config in it. This config will be added in all the server blocks generated by config. If you want to exclude a site from having this config, create a blank file at `/opt/easyengine/services/nginx-proxy/vhost.d/example.com`. To know more about how it works, refer to [jwilder/nginx-proxy's readme](https://github.com/jwilder/nginx-proxy#per-virtual_host).

#### SSL Certificates

SSL Certificates of all sites are stored at - `/opt/easyengine/services/nginx-proxy/certs`.

Each site which has SSL will have 3 files in here - 
`example.com.crt` - SSL Certificate(Public Key)
`example.com.key` - Private key
`example.com.chain.pem` - Certificate Chain File 

#### htpasswd

EasyEngine supports adding basic HTTP Authentication via [auth-command](https://github.com/easyengine/auth-command). The file having details of auth are kept at `/opt/easyengine/services/nginx-proxy/htpasswd`.

### Cron Scheduler
#### Config
Config for [ofelia](https://github.com/mcuadros/ofelia/) is kept at `/opt/easyengine/services/cron/config.ini`. It contains details of all crons added through EasyEngine.

### Redis
#### Logs
Logs of Redis can be found at `/opt/easyengine/services/redis/logs`.

#### Config
Config of Redis can be found at `/opt/easyengine/services/redis/config`.
You can add custom config at `/opt/easyengine/services/redis/conf/redis.conf.d/`

#### Data
Data of Redis can be found at `/opt/easyengine/services/redis/data`.

## Admin Tools
Admin tools of EasyEngine are mostly PHP based and kept at `/opt/easyengine/admin-tools`. This directory is created and admin tools are downloaded when you [enable admin-tools](https://github.com/EasyEngine/docs/blob/master/commands/admin-tools/enable.md#ee-admin-tools-enable) on a site for first time.

When you enable admin-tools on a site, this directory, `/opt/easyengine/admin-tools`, gets mounted in `htdocs/ee-admin` in the container. 

## EasyEngine Database

EasyEngine uses an sqlite database to keep track of it's state. It is located at `/opt/easyengine/db/ee.sqlite`
